<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Admin Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/admin.css">
</head>

<body>
    <div class="sidebar">
        <div class="sidebar-brand">
            <h2>SVES Admin</h2>
        </div>
        <div class="sidebar-menu">
            <a href="dashboard.html" class="active"><i class="fas fa-home"></i> Dashboard</a>
            <a href="manage-notes.html"><i class="fas fa-file-alt"></i> Manage Notes</a>
            <a href="manage-gallery.html"><i class="fas fa-images"></i> Manage Gallery</a>
            <a href="manage-announcements.html"><i class="fas fa-bullhorn"></i> Announcements</a>
            <a href="manage-faculty.html"><i class="fas fa-user-tie"></i> Faculty</a>
            <a href="manage-alumni.html"><i class="fas fa-user-graduate"></i> Alumni Stories</a>
            <a href="manage-faq.html"><i class="fas fa-question-circle"></i> FAQ Manager</a>
            <a href="manage-downloads.html"><i class="fas fa-download"></i> Downloads</a>
            <a href="#" id="logout-btn" style="margin-top: 50px; color: #ff6b6b;"><i class="fas fa-sign-out-alt"></i>
                Logout</a>
        </div>
    </div>

    <div class="main-content">
        <header class="header-bar">
            <h1>Dashboard Overview</h1>
            <div class="admin-profile flex align-center">
                <span>Welcome, <strong>Admin</strong></span>
                <i class="fas fa-user-circle" style="margin-left: 15px; font-size: 1.5rem;"></i>
            </div>
        </header>

        <div class="admin-body">
            <div class="card-grid" id="stats-container">
                <div class="stat-card">
                    <div>
                        <h3>Study Notes</h3>
                        <p class="stat-val" id="stat-notes">-</p>
                    </div>
                    <i class="fas fa-file-pdf" style="font-size: 2.5rem; color: #eee;"></i>
                </div>
                <div class="stat-card">
                    <div>
                        <h3>Gallery Photos</h3>
                        <p class="stat-val" id="stat-gallery">-</p>
                    </div>
                    <i class="fas fa-camera" style="font-size: 2.5rem; color: #eee;"></i>
                </div>
                <div class="stat-card">
                    <div>
                        <h3>Announcements</h3>
                        <p class="stat-val" id="stat-announcements">-</p>
                    </div>
                    <i class="fas fa-comment-dots" style="font-size: 2.5rem; color: #eee;"></i>
                </div>
                <div class="stat-card">
                    <div>
                        <h3>Faculty Members</h3>
                        <p class="stat-val" id="stat-faculty">-</p>
                    </div>
                    <i class="fas fa-user-tie" style="font-size: 2.5rem; color: #eee;"></i>
                </div>
            </div>

            <div class="flex" style="gap: 30px; margin-top: 50px; flex-wrap: wrap;">
                <!-- Visitor Analytics Mock -->
                <div
                    style="flex: 2; min-width: 300px; background: white; padding: 30px; border-radius: var(--radius-md); box-shadow: var(--shadow-sm);">
                    <div class="flex justify-between align-center" style="margin-bottom: 20px;">
                        <h2>Visitor Analytics</h2>
                        <select style="padding: 5px; border-radius: 4px; border: 1px solid #ddd;">
                            <option>Last 30 Days</option>
                            <option>Last 7 Days</option>
                        </select>
                    </div>
                    <div
                        style="height: 250px; background: #f9f9f9; border: 1px dashed #ddd; border-radius: 10px; display: flex; align-items: center; justify-content: center; position: relative;">
                        <div
                            style="position: absolute; bottom: 40px; left: 40px; right: 40px; top: 40px; display: flex; align-items: flex-end; gap: 10px;">
                            <div style="flex: 1; height: 40%; background: var(--primary); border-radius: 4px 4px 0 0;">
                            </div>
                            <div
                                style="flex: 1; height: 65%; background: var(--secondary); border-radius: 4px 4px 0 0;">
                            </div>
                            <div style="flex: 1; height: 50%; background: var(--primary); border-radius: 4px 4px 0 0;">
                            </div>
                            <div
                                style="flex: 1; height: 85%; background: var(--secondary); border-radius: 4px 4px 0 0;">
                            </div>
                            <div style="flex: 1; height: 45%; background: var(--primary); border-radius: 4px 4px 0 0;">
                            </div>
                            <div style="flex: 1; height: 30%; background: var(--primary); border-radius: 4px 4px 0 0;">
                            </div>
                            <div
                                style="flex: 1; height: 75%; background: var(--secondary); border-radius: 4px 4px 0 0;">
                            </div>
                        </div>
                        <p
                            style="color: var(--text-muted); z-index: 2; background: rgba(255,255,255,0.8); padding: 5px 15px; border-radius: 20px;">
                            Monthly Traffic Growth</p>
                    </div>
                    <div class="flex justify-between" style="margin-top: 20px;">
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.9rem;">Total Visits</p>
                            <h4 style="font-size: 1.5rem;">24,850</h4>
                        </div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.9rem;">Popular Page</p>
                            <h4 style="font-size: 1.5rem; color: var(--secondary);">/notes</h4>
                        </div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.9rem;">Avg. Time</p>
                            <h4 style="font-size: 1.5rem;">4m 32s</h4>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div
                    style="flex: 1; min-width: 250px; background: white; padding: 30px; border-radius: var(--radius-md); box-shadow: var(--shadow-sm);">
                    <h2>Quick Actions</h2>
                    <div class="flex" style="gap: 10px; margin-top: 20px; flex-direction: column;">
                        <a href="manage-notes.html" class="btn btn-primary" style="width: 100%; border-radius: 8px;"><i
                                class="fas fa-plus"></i> Upload Note</a>
                        <a href="manage-gallery.html" class="btn btn-secondary"
                            style="width: 100%; border-radius: 8px;"><i class="fas fa-plus"></i> Add Image</a>
                        <a href="manage-announcements.html" class="btn btn-outline"
                            style="width: 100%; border-radius: 8px;"><i class="fas fa-plus"></i> New Alert</a>
                    </div>
                </div>
            </div>
        </div>

        <footer class="admin-footer">
            <p>&copy; 2026 SVES Admin Portal. All Rights Reserved. | <a href="../index.html">Back to Website</a></p>
        </footer>
    </div>

    <script src="../assets/js/api.js"></script>
    <script>
        // Check authentication
        if (!isLoggedIn()) {
            window.location.href = 'login.html';
        }

        // CSP-compliant logout handler
        document.addEventListener('DOMContentLoaded', function () {
            var logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    localStorage.clear();
                    window.location.href = '../index.html';
                });
            }
        });

        // Load dashboard stats
        async function loadStats() {
            try {
                const stats = await apiGet('/dashboard/stats');
                document.getElementById('stat-notes').textContent = stats.notes;
                document.getElementById('stat-gallery').textContent = stats.gallery;
                document.getElementById('stat-announcements').textContent = stats.announcements;
                document.getElementById('stat-faculty').textContent = stats.faculty;
            } catch (error) {
                console.error('Failed to load stats:', error);
            }
        }

        document.addEventListener('DOMContentLoaded', loadStats);
    </script>
</body>

</html>